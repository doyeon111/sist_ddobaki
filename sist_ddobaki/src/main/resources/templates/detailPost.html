<!DOCTYPE html>
<html xmlns:th = "http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:inline="javascript">
/*<![CDATA[*/
	var rp=/*[[ ${rp} ]]*/
	function getParentReplyGroupInfo(reply_group){
	console.log("대댓글 쓰기 버튼 클릭됨!");
	console.log(reply_group);
	$("#reply_group").val(reply_group);
	$("#replyForm").attr("action", "/insertReReplyOK/"+reply_group);
	//console.log($("#replyForm").attr("action"));
	$.ajax({
		url:"/insertReReply/"+reply_group,
		//data:{reply_num:reply_num},
		success:function(arr){
			
	}})
	}

	$(function(){
		$("#subject").html(/*[[${b.post_title}]]*/);
		$("#content").html(/*[[${b.post_content}]]*/);
	});
/*]]*/
</script>
</head>
<body>
<th:block th:switch="${b.board_num}">
    <span th:case="1">notice</span>
    <span th:case="2">community</span>
    <span th:case="3">review</span>
    <span th:case="4">FAQ</span>
</th:block>
<hr>
<div>

<p id="subject"></p>
<p>글 번호 : <span th:text="${b.post_num}"></span></p>
<p>게시판 번호 : <span th:text="${b.board_num}"></span></p>
<p>사용자 닉네임 : <span th:text="${b.userinfo.user_nick}"></span></p>
<p>조회수 : <span th:text="${b.post_hit}+1"></span></p>
<th:block th:if="${b.board_num==3}">
<p>리뷰 장소 이름 : <span th:text="${b.place.place_name}"></span></p>
<p>리뷰 장소 주소 : <span th:text="${b.place.place_addr}"></span></p>
</th:block>
<hr>
게시글 내용 : <p id="content"></p>
</div>
<hr>
<legend>댓글 내역</legend>
 
<div id="detailReplyByPostNum">
<table>
<tr>
        <thead>
          <tr>
          	<th>댓글번호</th>
            <th>작성자</th>
            <th></th>
            <th>댓글</th>
            <th>action</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
            <tr th:each="rp:${reply_list}">
            <td th:text="${rp.reply_num}"></td>
            <td th:text="${rp.userinfo.user_nick}"></td>
            <th:block th:if="${rp.reply_level==1}">
				<td>ㄴ</td>
			</th:block>
			<th:block th:unless="${rp.reply_level==1}">
				<td></td>
			</th:block>
            <td th:text="${rp.reply_content}"></td>
          	<td><button>삭제</button></td>
          	<td><button  id="btnInsertReReply" type="button" th:myNum="${rp.reply_group}" th:onclick="getParentReplyGroupInfo(this.getAttribute('myNum'))">답글쓰기</button></td>
          </tr>
        </tbody>
</table>

</div>

<hr>
<form id="replyForm" method="post" action="/insertReplyOK">
	<input type="hidden" th:name="post_num" th:value="${b.post_num}">
	<input type="hidden" th:name="board_num" th:value="${b.board_num}">
	<input type="hidden" name="reply_group" id="reply_group" value="0">
	사용자 : <select name="user_num">
		<option> 사용자선택 </option>
		<option th:each="u : ${user_list}"
				th:value="${u?.user_num}"
				th:utext="${u?.user_nick}"></option>
		</select>
	<br>
	<textarea id="reply_content" name="reply_content" rows="2" cols="90"></textarea>
	<button type="submit" id="submit" name="submit">등록</button>
</form>
<hr>
<button><a th:href="@{/updateBoard/{post_num}(post_num=${b.post_num})}">수정</a></button>
<button><a th:href="@{/deleteBoard/{post_num}(post_num=${b.post_num})}">삭제</a></button>
</body>
</html>